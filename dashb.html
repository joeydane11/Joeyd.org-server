<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard</title>
  <script>
    async function fetchUserInfo(accessToken) {
      try {
        // Fetch user info from Roblox API using the access token
        const response = await fetch("https://apis.roblox.com/v1/users/authenticated", {
          headers: {
            Authorization: `Bearer ${accessToken}`
          }
        });

        if (response.ok) {
          const data = await response.json();
          document.getElementById("username").innerText = data.name;
          document.getElementById("avatar").src = `https://www.roblox.com/headshot-thumbnail/image?userId=${data.id}&width=150&height=150&format=png`;
          document.getElementById("user-info").style.display = "block";
        } else {
          console.error("Failed to fetch user info. Please try again.");
        }
      } catch (error) {
        console.error("Error fetching user info:", error);
      }
    }

    window.onload = function () {
      const urlParams = new URLSearchParams(window.location.hash.substring(1)); // Use hash params for token
      const accessToken = urlParams.get("access_token");

      if (accessToken) {
        fetchUserInfo(accessToken);
      } else {
        alert("No access token found. Please log in again.");
        window.location.href = "index.html";
      }
    };
  </script>
  <style>
    #user-info {
      display: none;
      position: absolute;
      top: 10px;
      right: 10px;
    }

    #user-info img {
      border-radius: 50%;
    }
  </style>
</head>
<body>
  <h1>Welcome to the Dashboard</h1>
  <div id="user-info">
    <span id="username"></span>
    <img id="avatar" alt="Avatar" />
  </div>
</body>
</html>
